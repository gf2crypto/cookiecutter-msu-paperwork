%!TEX root = ../graduate-work.tex

\section[Множество открытых ключей криптосистемы Мак-Элиса---Си\-дель\-ни\-кова]{Множество открытых ключей криптосистемы Мак-Элиса---Сидельникова}

Дадим следующее определение эквивалентности секретных ключей
криптосистемы Мак-Элиса--Сидельникова. \Def{Секретные ключи
$(H_1,H_2,\ldots,H_u,\Gamma)$ и $(H'_1,H'_2,\ldots,H'_u,\Gamma')$
назовём \emph{эквивалентными}, если соответствующие им открытые
ключи совпадают, то есть выполняется соотношение
$$(H_1R\|H_2R\|\ldots\|H_uR)\cdot
\Gamma=(H'_1R\|H'_2R\|\ldots\|H'_uR)\cdot \Gamma'.$$}

Заметим, что данное отношение действительно является отношение
эквивалентности. Тем самым всё множество секретных ключей
разбивается на классы эквивалентности и число классов
эквивалентности совпадает с числом открытых ключей. Рассмотрим
множество
\begin{eqnarray*}
\mathcal G(H_1,H_2,\ldots,H_u)&=&\{\Gamma\in S_{un}:
\exists H'_1,H'_2,\ldots H'_u \text{ такие, что }\\
&&(H_1R\|H_2R\|\ldots\|H_uR)\Gamma=(H'_1R\|H'_2R\|\ldots\|H'_uR)\}
\end{eqnarray*}
Как и раньше класс эквивалентности с представителем
$(H_1,\ldots,H_u,\Gamma)$ будем обозначать так:
$[(H_1,\ldots,H_u,\Gamma)]$.

Справедлива следующая теорема.
\begin{theorem}
Существует взаимно однозначное отображение между классом $[(H_1,H_2,\ldots,H_u,\Gamma)]$ и множеством
$\mathcal G(H_1,H_2,\ldots,H_u)$.
\end{theorem}
\begin{proof}
Для начала заметим, что тождественная перестановка $Id$
принадлежит множеству $\mathcal G(H_1,H_2,\ldots,H_u)$. Рассмотрим
отображение $f$, переводящее любой ключ
$(M_1,M_2,\ldots,M_u,\Gamma')$ из класса эквивалентности секретного ключа
$(H_1,H_2,\ldots,H_u,\Gamma)$ в перестановку
$\Gamma\Gamma'^{-1}.$ Из соотношения

$$(H_1R\|H_2R\|\ldots\|H_uR)\Gamma=(M_1R\|M_2R\|\ldots\|M_uR)\Gamma'$$
следует, что перестановка $\Gamma\Gamma'^{-1}$ принадлежит
множеству $\mathcal G(H_1,H_2,\ldots,H_u)$.

Докажем, что $f$
--- инъекция. Пусть два ключа $$(A_1,A_2,\ldots,A_u,\Gamma_1)
\text{ и } (B_1,B_2,\ldots,B_u,\Gamma_2)$$ из рассматриваемого
класса эквивалентности переводятся с помощью $f$ в перестановки
$\Gamma\Gamma^{-1}_1$ и $\Gamma\Gamma^{-1}_2$ соответственно, так,
что $\Gamma\Gamma^{-1}_1=\Gamma\Gamma^{-1}_2$. Тогда
$\Gamma_1=\Gamma_2$, а значит и
$$A_1=B_1, A_2=B_2,\ldots,A_u=B_u,$$ то есть ключи совпадают.

Теперь рассмотрим перестановку $\Gamma_g$ из множества
$\mathcal G(H_1,H_2,\ldots,H_u)$. Тогда для $\Gamma_g$ найдутся
такие матрицы $H'_1,H'_2,\ldots,H'_u$, что
$$(H_1R\|H_2R\|\ldots\|H_uR)\cdot
\Gamma_g=(H'_1R\|H'_2R\|\ldots\|H'_uR).$$ Положим
$$\Gamma'=\Gamma^{-1}_g\Gamma,M_1=H'_1,\ldots,M_1=H'_u.$$
В этом случае
$$(H'_1R\|H'_2R\|\ldots\|H'_uR)\cdot
\Gamma^{-1}_g\Gamma=(H_1R\|H_2R\|\ldots\|H_uR)\Gamma,$$ то есть
секретный ключ $(M_1,M_2,\ldots,M_u,\Gamma^{-1}_g\Gamma)$
эквивалентен\\ ключу $(H_1,H_2,\ldots,H_u,\Gamma)$. Тем самым
доказано, что отображение $f$ сюръективно.

Итак, отображение $f$ инъективно и сюръективно, а значит $f$ ---
взаимно однозначное отображение класса эквивалентности с
представителем $(H_1,H_2,\ldots,H_u,\Gamma)$ в множество $\mathcal
G(H_1,H_2,\ldots,H_u)$.
\end{proof}
\begin{corollary}\label{cor41}
Справедлива формула для мощности класса эквивалентности
$$|[(H_1,H_1,\ldots,H_u,\Gamma)]|=|\mathcal G(H_1,H_2,\ldots,H_u)|$$
\end{corollary}

Тем самым вопрос изучения эквивалентных секретных ключей сводится
к описанию множеств $\mathcal G(H_1,\ldots,H_u)$.

Далее установим связь множества $\mathcal G(H_1,\ldots,H_u)$ с
множеством
\begin{eqnarray*}
\mathcal L(H_1,\ldots,H_u)&=&\{(A_1,\ldots,A_u)\text{ --- кортеж
невырожденных матриц,}\\
&&\text{для которых существует перестановка }\Gamma\in S_{un}:\\
&&(H_1R\|\ldots\|H_uR)\Gamma=(A_1R\|\ldots\|A_uR).\}
\end{eqnarray*}

\begin{proposition}
Зафиксируем некоторые невырожденные двоичные $k\times k$-матрицы
$H_1,\ldots,H_u$. Тогда множество $\mathcal G(H_1,\ldots,H_u)$
можно представить в виде объединения непересекающихся множеств
$$
\mathcal G(H_1,\ldots,H_u)=\bigcup_{(A_1,\ldots,A_u)\in\mathcal
L(H_1,\ldots,H_u)}\{\gamma_\phi\Gamma_{A_1,\ldots,A_u}|\gamma_\phi\in\Gamma_{\phi}(H_1,\ldots,H_u)\}.
$$
здесь $\Gamma_{A,\ldots,A_u}$ --- некоторая перестановка из
$S_{un}$, для которой
$$
(H_1R\|\ldots\|H_uR)\Gamma_{A_1,\ldots,A_u}=(A_1R\|\ldots\|A_uR).
$$
Символом $\Gamma_{\phi}(H_1,\ldots,H_u)$ обозначено множество таких перестановок \(\gamma_{\phi}\in S_{un},\) что
$$
(H_1R\|H_2R\|\ldots\|H_uR)\gamma_\phi=(H_1R\|H_2R\|\ldots\|H_uR).$$
\end{proposition}
\begin{proof}
Из определения множества $\mathcal G(H_1,\ldots,H_u)$ следует, что
$$
\mathcal G(H_1,\ldots,H_u)=\bigcup_{A_1,\ldots,A_u}\{\Gamma\in
S_{un}:(H_1||\ldots||H_u)\Gamma=(A_1R||\ldots||A_uR)\}.
$$
Очевидно, что множества, стоящие под знаком объединения не
пересекаются. Далее, пусть существуют две перестановки
$\Gamma_1,\Gamma_2\in S_{un}$ такие, что
\begin{eqnarray*}
(H_1R\|\ldots\|H_uR)\Gamma_1&=&(H'_1R\|\ldots\|H'_uR)\\
(H_1R\|\ldots\|H_uR)\Gamma_2&=&(H'_1R\|\ldots\|H'_uR).
\end{eqnarray*}
Тогда
$$
(H_1R\|\ldots\|H_uR)\Gamma_2\Gamma^{-1}_1=(H_1R\|\ldots\|H_uR).
$$
Тем самым перестановка $\Gamma_2\Gamma^{-1}_1$ принадлежит
множеству $\Gamma_{\phi}(H_1,\ldots,H_u)$. Обратно, если для
перестановки $\Gamma_1$ выполнено соотношение
\begin{equation}
\label{eq1} (H_1R\|\ldots\|H_uR)\Gamma_1=(H'_1R\|\ldots\|H'_uR),
\end{equation}
то для любой $\gamma_\phi\in\Gamma_{\phi}(H_1,\ldots,H_u)$
перестановка $\Gamma_2=\gamma_\phi\Gamma_1$ также
удовлетворяет~(\ref{eq1}). Тем самым доказано, что любое непустое
множество \(\{\Gamma\in
S_{un}:(H_1||\ldots||H_u)\Gamma=(A_1R||\ldots||A_uR)\}\), стоящее под знаком объединения равно следующему множеству
$
\{\gamma_\phi\Gamma_{A_1,\ldots,A_u}|\gamma_\phi\in\Gamma_{\phi}(H_1,\ldots,H_u)\},
$
где $\Gamma_{A,\ldots,A_u}$ --- некоторая перестановка из
$S_{un}$, для которой
$$
(H_1R\|\ldots\|H_uR)\Gamma_{A_1,\ldots,A_u}=(A_1R\|\ldots\|A_uR).
$$
Для завершения доказательства осталось заметить, что множества,
стоящие под знаком объединения не пустые, если и только если
кортеж $(A_1,\ldots,A_u)$ принадлежит множеству $\mathcal
L(H_1,\ldots,H_u)$.

Утверждение полностью доказано.
\end{proof}

Следствием предыдущего утверждения является формула, связывающая
мощности множеств $\mathcal G(H_1,\ldots,H_u)$ и $\mathcal
L(H_1,\ldots,H_u)$.
\begin{proposition}
\label{prop1} Справедлива формула
$$
|\mathcal
G(H_1,\ldots,H_u)|=|\Gamma_{\phi}(H_1,\ldots,H_u)|\cdot|\mathcal
L(H_1,\ldots,H_u)|.
$$
\end{proposition}

Занумеруем все столбцы матрицы $(H_1R\|\ldots\|H_uR)$ числами от
$1$ до $un$. Обозначим через $\mathcal N^u$ множество всех номеров
от $1$ до $un$, то есть $\mathcal N^u=\{1,2,\ldots,un\}$. Пусть
также для любого $i\in\mathcal{N}^u$ $(H_1R\|\ldots\|H_uR)_i$ ---
$i$-тый столбец матрицы $(H_1R\|\ldots\|H_uR)$.

Следующее утверждение описывает строение множества
$\Gamma_{\phi}(H_1,\ldots,H_u)$.

\begin{proposition} \label{prop43}
Перестановка $\Gamma$ принадлежит множеству
$\Gamma_{\phi}(H_1,\ldots,H_u)$, если и только если для любых
$i,j\in \mathcal{N}^u$, таких что $\Gamma(i)=j$, выполняется
равенство
 $$
 (H_1R\|\ldots\|H_uR)_i=(H_1R\|\ldots\|H_uR)_j.
 $$
\end{proposition}

\begin{proof}
Немедленно следует из того, что $\Gamma$ принадлежит множеству
$\Gamma_{\phi}(H_1,\ldots,H_u)$ тогда и только тогда, когда верно
равенство
 $$
 (H_1R\|\ldots\|H_uR)\Gamma=(H_1R\|\ldots\|H_uR).
 $$
\end{proof}


Выясним некоторые свойства множества $\mathcal L(H_1,\ldots,H_u)$.
Обозначим через\\ $\mathcal A(RM(r,m))$ множество матриц, которые
задают перестановки, принадлежащие группе автоморфизмов кода
$RM(r,m)$ с порождающей матрицей $R$, то есть
$$
\mathcal A(RM(r,m))=\{A|\exists \Gamma\in Aut(RM(r,m)):
AR=R\Gamma\}.
$$
\begin{proposition} \label{prop44}
Пусть кортеж $(A_1,\ldots,A_u)$ принадлежит множеству\\ $\mathcal
L(H_1,\ldots,H_u)$. Тогда для любых матриц $D_1,\ldots,D_u\in
\mathcal A(RM(r,m))$ и любой перестановки $\Gamma\in S_u$ кортеж
$$
(A_{\Gamma(1)}D_1,\ldots,A_{\Gamma(u)}D_u)
$$
также принадлежит множеству $\mathcal L(H_1,\ldots,H_u)$.
\end{proposition}
\begin{proof} Зафиксируем любые матрицы $D_1,\ldots,D_u\in
\mathcal A(RM(r,m))$ и любую перестановку $\Gamma\in S_u$. Тогда
для матриц $D_1,\ldots,D_u$ найдутся перестановки
$\Gamma_1,\ldots,\Gamma_u$, принадлежащие $S_n$, такие что
$$
D_iR=R\Gamma_i,\;\forall i=1,\ldots,u.
$$
Далее, по перестановке $\Gamma$ построим перестановку
$\widetilde\Gamma\in S_{un}$, которая моделирует действие
перестановки $\Gamma$, то есть $\widetilde\Gamma$ переставляет
конкатенируемые блоки $A_i R$ так, что $(A_1 R||\ldots||A_u
R)\widetilde\Gamma=(A_{\Gamma(1)} R||\ldots||A_{\Gamma(u)} R)$.
Так как кортеж $(A_1,\ldots,A_u)$ принадлежит множеству $\mathcal
L(H_1,\ldots,H_u)$, то найдётся перестановка $P\in S_{un}$ такая,
что
$$
(H_1R\|\ldots\|H_uR)P=(A_1R\|\ldots\|A_uR).
$$
Теперь построим перестановку
$\Gamma_P=P\widetilde\Gamma(\Gamma_1\|\ldots\|\Gamma_u)$. Легко
проверить, что кортеж $(A_{\Gamma(1)}D_1,\ldots,A_{\Gamma(u)}D_u)$
будет удовлетворять соотношению, задающему множество $\mathcal
L(H_1,\ldots,H_u)$ именно с перестановкой $\Gamma_P$.
\end{proof}
Утверждение~\ref{prop44} позволяет разбить всё множество $\mathcal
L(H_1,\ldots,H_u)$ на классы эквивалентности. \Def{Назовём два
кортежа $(A_1,\ldots,A_u)$ и $(B_1,\ldots,B_u)$ из множества
$\mathcal L(H_1,\ldots,H_u)$ \emph{эквивалентными}, если }
$$
\exists \Gamma\in S_{u}:\forall
i=1,\ldots,u\;A^{-1}_iB_{\Gamma(i)}\in\mathcal A(RM(r,m)).
$$
В дальнейшем класс эквивалентности в множестве $\mathcal
L(H_1,\ldots,H_u)$ будем называть \emph{$A$-классом}. $A$-класс с
представителем $(H_1,\ldots,H_u)$ будем обозначать следующим
образом: $A[(H_1,\ldots,H_u)]$.

Для выяснения дальнейших свойств множества $\mathcal
L(H_1,\ldots,H_u)$ потребуется следующая лемма.

\begin{lemma}
\label{lem1} Рассмотрим $H_1,\ldots,H_u$~--- последовательность невырожденных матриц. Если существует номер $i$ такой, что для любого
$j=1,\ldots,u$ матрица $H^{-1}_iH_j$ принадлежит $\mathcal
A(RM(r,m))$, то для любых $k,l=1,2,\ldots,u$ матрица $H^{-1}_kH_l$
принадлежит $\mathcal A(RM(r,m))$.
\end{lemma}
\begin{proof}
Заметим, что множество $\mathcal A(RM(r,m))$ является группой в
силу того, что $Aut(RM(r,m))$ --- группа. Возьмём две любые
матрицы $H_k$ и $H_l$ из кортежа, по условию существует матрица
$H_i$ такая, что $H^{-1}_iH_k\in\mathcal A(RM(r,m))$ и
$H^{-1}_iH_l\in\mathcal A(RM(r,m))$. Это означает, что найдутся
две матрицы $D_1,D_2\in\mathcal A(RM(r,m))$, для которых
$$
H_k=H_iD_1,\;H_l=H_iD_2.
$$
Вычислим $H^{-1}_kH_l$:
$$
H^{-1}_kH_l=D^{-1}_1H^{-1}_iH_iD_2=D^{-1}_1D_2.
$$
Так как $\mathcal A(RM(r,m))$ группа, то $D^{-1}_1D_2\in\mathcal
A(RM(r,m))$, а значит\\ и $H^{-1}_kH_l\in\mathcal A(RM(r,m))$.
\end{proof}
\begin{proposition}
\label{prop2} Пусть матрицы $H_1,\ldots,H_u$ таковы, что
существует номер $i$, с которым выполняется условие
$$
\forall j=1,2,\ldots,u\ \ \ \ H^{-1}_iH_j\in\mathcal A(RM(r,m)).
$$
Тогда
\begin{itemize}
\item[1)] в множестве $\mathcal L(H_1,\ldots,H_u)$ существует единственный\\ $A$-класс $A[(H_1,\ldots,H_u)]$;
\item[2)] мощность этого $A$-класса равна $|Aut(RM(r,m))|^u$.
\end{itemize}
\end{proposition}
\begin{proof}
Для начала заметим, что в множестве $\mathcal L(H_1,\ldots,H_u)$
существует $A$-класс с представителем $(H_1,\ldots,H_u)$. Возьмём
теперь любой кортеж матриц $(A_1,\ldots,A_u)$ из множества
$\mathcal L(H_1,\ldots,H_u)$. Для него найдётся перестановка
$\Gamma$ такая, что
$$
(H_1R\|H_2R\|\ldots\|H_uR)\Gamma=(A_1R\|A_2R\|\ldots\|A_uR).
$$
Умножим левую и правую часть равенства на невырожденную матрицу
$H^{-1}_i$. Тогда получим
\begin{multline*}
(H^{-1}_iH_1R\|\ldots\|H^{-1}_iH_{i-1}R\|ER\|H^{-1}_iH_{i+1}R\|\ldots\|H^{-1}_iH_uR)\Gamma=\\=(H^{-1}_iA_1R\|\ldots\|H^{-1}_iA_uR).    
\end{multline*}
В силу того, что $H^{-1}_iH_j\in \mathcal A(RM(r,m))$, то
существуют перестановки из $\Gamma_1,\ldots,\Gamma_u\in S_n$, для
которых
$$
(R\|\ldots\|R)(\Gamma_1\|\ldots\|\Gamma_{i-1}\|E\|\Gamma_{i+1}\|\ldots\|\Gamma_u)\Gamma=(H^{-1}_iA_1R\|\ldots\|H^{-1}_iA_uR).
$$
Г.~А.~Карпунин доказал~\cite{Karpunin}, что перестановку, стоящую
в левой части последнего равенства можно представить в виде
$g_{\phi}\widetilde\Gamma$, где $\widetilde\Gamma$ --- блоковая
перестановка, составленная из автоморфизмов кода $RM(r,m)$,
$g_{\phi}$
--- некоторая перестановка из множества  $\Gamma_{\phi}(E,E,\ldots,E)$. Учитывая всё
сказанное, получаем
$$
(D_1R\|\ldots\|D_uR)=(H^{-1}_iA_1R\|\ldots\|H^{-1}_iA_uR)
$$
для некоторых матриц $D_1,\ldots,D_u\in \mathcal A(RM(r,m))$.
Откуда следует, что
$$
A_j=H_iD_j,\forall\;j=1,2,\ldots,u.
$$
Осталось заметить, что любая матрица $H_j$ может быть представлена
в виде $H_j=H_iB_j$, где $B_j\in\mathcal A(RM(r,m))$. Тем самым
любой кортеж $(A_1,\ldots,A_u)\in\mathcal L(H_1,\ldots,H_u)$
принадлежит $A$-классу $A[(H_1,\ldots,H_u)]$.

Вычислим теперь мощность $A$-класса с представителем
$(H_1,\ldots,H_u)$. Для этого возьмём два набора матриц $D'_1,\ldots,D'_u$ и
$D''_1,\ldots,D''_u$ из множества $\mathcal A(RM(r,m))$. Пусть
существует номер $i$ такой, что $D'_i\neq D''_i$, тогда
$H_iD'_i\neq H_iD''_i$. Итак, если два набора матриц из множества
$\mathcal A(RM(r,m))$ различны, то и различны наборы
$(H_1D'_1,\ldots,H_uD'_u)$, $(H_1D''_1,\ldots,H_uD''_u)$. Возьмём
теперь любую перестановку $\Gamma$ из множества $S_u$. Рассмотрим
два набора $(H_1,\ldots,H_u)$ и
$(H_{\Gamma(1)},\ldots,H_{\Gamma(u)})$. В силу леммы~\ref{lem1}
$H^{-1}_kH_{l=\Gamma(k)}\in\mathcal A(RM(r,m))$. Тогда рассмотрим такой
кортеж $(H_1D_1,\ldots,H_uD_u)$, что
$D_k=H^{-1}_kH_{l=\Gamma(k)}\in\mathcal A(RM(r,m))$. Этот кортеж
совпадает с $(H_{\Gamma(1)},\ldots,H_{\Gamma(u)})$. Тем самым для
любой перестановки $\Gamma$ найдётся набор матриц
$D_1,\ldots,D_u\in\mathcal A(RM(r,m))$ такой, что
$$
H_{\Gamma(j)}=H_jD_j.
$$
Итак, все элементы $A$-класса $A[(H_1,\ldots,H_u)]$ получаются
только умножением каждой $H_i$ на некоторую матрицу из $\mathcal
A(RM(r,m))$. Откуда следует, что мощность класса эквивалентности $[(H_1,\ldots,H_u)]$ равна $|Aut(RM(r,m))|^u$.
\end{proof}

Из утверждения~\ref{prop1} и~\ref{prop2} следует теорема.
\begin{theorem}\label{t1}
Пусть матрицы $H_1,\ldots,H_u$ таковы, что существует номер $i$, с
которым выполняется условие
$$
\forall j=1,2\ldots,u\ \ \ \ H^{-1}_iH_j\in\mathcal A(RM(r,m)).
$$
Тогда
$$
|\mathcal G(H_1,\ldots,H_u)|=(u!)^n|Aut(RM(r,m))|^u.
$$
\end{theorem}
\begin{proof}
Из утверждений~\ref{prop1} и~\ref{prop2} следует, что
$$
|\mathcal
G(H_1,\ldots,H_u)|=|\Gamma_{\phi}(H_1,\ldots,H_u)||Aut(RM(r,m))|^u.\eqno{(2)}
$$
По условию найдётся такая матрица $H_i$, что $H^{-1}_iH_j$ для
любого номера $j=1,2,\ldots,u$ принадлежит множеству $\mathcal
A(RM(r,m))$. В силу этого все матрицы $H_jR$, $j=1,2,\ldots,u$,
состоят из одних и тех же столбцов.

Напомним, см.~утверждение~\ref{prop43}, что в множестве
$\Gamma_{\phi}(H_1,\ldots,H_u)$ лежат только перестановки меняющие
местами блоки одинаковых столбцов. Значит, в нашем случае мощность
этого множества будет равна $(u!)^n$. Учитывая соотношение~(2),
получаем требуемую формулу.
\end{proof}

Из последнего утверждения можно получить важное следствие
--- оценку снизу на мощность множества открытых ключей криптосистемы Мак-Элиса--Сидельникова.

\begin{proposition}
Справедлива оценка снизу  на мощность множества открытых ключей
$$
\frac{h_k(u\cdot n)!}{(u!)^n}\leqslant |\mathcal E|.
$$
\end{proposition}
\begin{proof}
Рассмотрим следующее множество \(\mathcal H\) секретных ключей:
\begin{multline*}
    \mathcal H=\{(HD_1,HD_2,\ldots,HD_u,\Gamma)|\\ H\in
GL_k(F_2)\;D_1,D_2,\ldots,D_u\in\mathcal A(RM(r,m)), \Gamma\in
S_{un}\}.
\end{multline*}
Множество $\mathcal H$ замкнуто относительно эквивалентности
секретных ключей. Действительно, пусть ключи
$(HD_1,\ldots,HD_u,\Gamma)$ и $(H'_1,\ldots,H'_u,\Gamma')$
эквивалентны, то есть
$$
(HD_1R\|\ldots\|HD_uR)\Gamma=(H'_1R\|\ldots\|H'_uR)\Gamma'.
$$
Рассмотрим перестановки $\Gamma_1,\Gamma_2,\ldots,\Gamma_u\in
Aut(RM(r,m))$, для которых
$$
D_1R=R\Gamma_1\;\;D_2R=R\Gamma_2\;,\ldots,\;D_uR=R\Gamma_u.
$$
Тогда
$$
(R\|\ldots\|R)(\Gamma_1\|\ldots\|\Gamma_u)\Gamma\Gamma'^{-1}=(H^{-1}H'_1R\|\ldots\|H^{-1}H'_uR).
$$
Как и в утверждении~\ref{prop2}, отсюда немедленно следует, что
найдутся матрицы $D'_1,\ldots,D'_u\in \mathcal A(RM(r,m))$ такие,
что
$$
H'_1=HD'_1,\;\ldots,\;H'_u=HD'_u.
$$
Что означает принадлежность ключа $(H'_1,\ldots,H'_u,\Gamma')$
множеству $\mathcal H$.

Таким образом, множество $\mathcal H$ разбивается на классы
эквивалентности. Из следствия~\ref{cor41} и теоремы~\ref{t1}
вытекает, что эти классы будут иметь одинаковую мощность, равную
$(u!)^n|Aut(RM(r,m))|^u$. Но тогда число классов эквивалентности в
этом множестве будет в точности равно отношению мощности $\mathcal
H$, которая очевидно равна $h_k|Aut(RM(r,m))|^u(u\cdot n)!$, к
мощности класса эквивалентности, то есть
$$
\frac{h_k|Aut(RM(r,m))|^u(u\cdot
n)!}{(u!)^n|Aut(RM(r,m))|^u}=\frac{h_k(u\cdot n)!}{(u!)^n}.
$$
Осталось заметить, что $\mathcal H$ --- подмножество секретных
ключей, поэтому число классов эквивалентности, а значит и число
открытых ключей, будет не меньше чем число классов в множестве
$\mathcal H$, то есть
$$
\frac{h_k(u\cdot n)!}{(u!)^n}\leqslant |\mathcal E|.
$$
Что и требовалось доказать.
\end{proof}
Учитывая результат, полученный Г~.~А~.~Карпуниным~\cite{Karpunin},
можно сформулировать теорему
\begin{theorem}\label{t3}
Справедливы неравенства для числа открытых ключей криптосистемы
Мак-Элиса--Сидельникова
$$
\frac{h_k(u\cdot n)!}{(u!)^n}\leqslant |\mathcal E|<\frac{(u\cdot
n)!(h_k)^u}{u!|Aut(RM(r,m))|^u}.
$$
\end{theorem}


Следует отметить, что результаты данного параграфа можно без
изменений переформулировать для любого линейного кода на любым
конечным полем $F_q$.